
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Automatic documentation from sources, for MkDocs.">
      
      
      
      
        <link rel="prev" href="../scaler_utils/">
      
      
        <link rel="next" href="../user_defined_functions/">
      
      
      <link rel="icon" href="../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>transform_utils - Kamae</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.kamae.spark.utils.transform_utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Kamae" class="md-header__button md-logo" aria-label="Kamae" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kamae
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              transform_utils
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ExpediaGroup/kamae" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    kamae
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Kamae" class="md-nav__button md-logo" aria-label="Kamae" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kamae
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ExpediaGroup/kamae" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    kamae
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../adding_transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding new transforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../achieving_type_parity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Achieving type parity between Spark & Keras
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../achieving_shape_parity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Achieving shape parity between Spark & Keras
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../chaining_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chaining models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../testing_inference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing inference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    src
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            src
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    kamae
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            kamae
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../graph/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    graph
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_1" id="__nav_2_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            graph
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph/pipeline_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pipeline_graph
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    sklearn
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_2" id="__nav_2_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../sklearn/estimators/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    estimators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_2_1" id="__nav_2_1_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            estimators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/estimators/standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../sklearn/params/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    params
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_2_2" id="__nav_2_1_1_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            params
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/params/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/params/name/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    name
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/params/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../sklearn/pipeline/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pipeline
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_2_3" id="__nav_2_1_1_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/pipeline/pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../sklearn/transformers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    transformers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_2_4" id="__nav_2_1_1_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            transformers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/transformers/array_concatenate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_concatenate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/transformers/array_split/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_split
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/transformers/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/transformers/identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sklearn/transformers/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    spark
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3" id="__nav_2_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            spark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../common/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    common
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3_1" id="__nav_2_1_1_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            common
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/spark_operation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_operation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../estimators/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    estimators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3_2" id="__nav_2_1_1_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            estimators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/conditional_standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conditional_standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/impute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/min_max_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min_max_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/one_hot_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    one_hot_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/shared_one_hot_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shared_one_hot_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/shared_string_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shared_string_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/single_feature_array_standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    single_feature_array_standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimators/string_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../params/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    params
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3_3" id="__nav_2_1_1_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            params
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../params/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../params/default_read_write/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    default_read_write
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../params/name/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    name
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../params/shared/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shared
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../params/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../pipeline/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pipeline
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3_4" id="__nav_2_1_1_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_3_4">
            <span class="md-nav__icon md-icon"></span>
            pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline/pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline/pipeline_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pipeline_model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../transformers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    transformers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3_5" id="__nav_2_1_1_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_3_5">
            <span class="md-nav__icon md-icon"></span>
            transformers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/absolute_value/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    absolute_value
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/array_concatenate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_concatenate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/array_crop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_crop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/array_split/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_split
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/array_subtract_minimum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_subtract_minimum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/bearing_angle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bearing_angle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/bin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/bloom_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bloom_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/bucketize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bucketize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/conditional_standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conditional_standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/cosine_similarity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cosine_similarity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/current_date/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current_date
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/current_date_time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current_date_time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/current_unix_timestamp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current_unix_timestamp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/date_add/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_add
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/date_diff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_diff
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/date_parse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_parse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/date_time_to_unix_timestamp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_time_to_unix_timestamp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/divide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    divide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/exp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/exponent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exponent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/hash_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hash_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/haversine_distance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    haversine_distance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/if_statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    if_statement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/impute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/lambda_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lambda_function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/list_max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_max
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/list_mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_mean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/list_median/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_median
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/list_min/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_min
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/list_rank/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_rank
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/list_std_dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_std_dev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/logical_and/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_and
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/logical_not/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_not
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/logical_or/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_or
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    max
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/min/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/min_hash_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min_hash_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/min_max_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min_max_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/modulo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    modulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/multiply/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiply
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/numerical_if_statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    numerical_if_statement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/one_hot_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    one_hot_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/ordinal_array_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ordinal_array_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/round/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    round
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/round_to_decimal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    round_to_decimal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/shared_one_hot_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shared_one_hot_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/shared_string_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shared_string_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_affix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_affix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_array_constant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_array_constant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_case
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_concatenate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_concatenate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_contains/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_contains
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_contains_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_contains_list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_equals_if_statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_equals_if_statement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_isin_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_isin_list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_list_to_string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_list_to_string
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_replace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_replace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/string_to_string_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_to_string_list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/sub_string_delim_at_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sub_string_delim_at_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/subtract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    subtract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/sum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformers/unix_timestamp_to_date_time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unix_timestamp_to_date_time
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_3_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_3_6" id="__nav_2_1_1_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_1_3_6">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../array_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../indexer_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    indexer_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../list_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaler_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scaler_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    transform_utils
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    transform_utils
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils" class="md-nav__link">
    <span class="md-ellipsis">
      transform_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils._multi_input_single_output_transform" class="md-nav__link">
    <span class="md-ellipsis">
      _multi_input_single_output_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils._single_input_single_output_transform" class="md-nav__link">
    <span class="md-ellipsis">
      _single_input_single_output_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils._single_input_single_output_udf_transform" class="md-nav__link">
    <span class="md-ellipsis">
      _single_input_single_output_udf_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.multi_input_single_output_array_transform" class="md-nav__link">
    <span class="md-ellipsis">
      multi_input_single_output_array_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.multi_input_single_output_scalar_transform" class="md-nav__link">
    <span class="md-ellipsis">
      multi_input_single_output_scalar_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_array_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_array_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_array_udf_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_array_udf_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_scalar_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_udf_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_scalar_udf_transform
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_defined_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    user_defined_functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    tensorflow
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_4" id="__nav_2_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_4_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tensorflow/layers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    layers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_4_1" id="__nav_2_1_1_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/absolute_value/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    absolute_value
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/array_concatenate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_concatenate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/array_crop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_crop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/array_split/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_split
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/array_subtract_minimum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array_subtract_minimum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/bearing_angle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bearing_angle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/bin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/bloom_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bloom_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/bucketize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bucketize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/conditional_standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conditional_standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/cosine_similarity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cosine_similarity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/current_date/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current_date
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/current_date_time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current_date_time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/current_unix_timestamp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    current_unix_timestamp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/date_add/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_add
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/date_diff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_diff
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/date_parse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_parse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/date_time_to_unix_timestamp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_time_to_unix_timestamp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/divide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    divide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/exp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/exponent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exponent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/hash_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hash_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/haversine_distance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    haversine_distance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/if_statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    if_statement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/impute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/lambda_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lambda_function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/list_max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_max
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/list_mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_mean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/list_median/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_median
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/list_min/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_min
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/list_rank/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_rank
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/list_std_dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_std_dev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/logical_and/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_and
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/logical_not/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_not
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/logical_or/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_or
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    max
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/min/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/min_hash_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min_hash_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/min_max_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    min_max_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/modulo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    modulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/multiply/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiply
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/numerical_if_statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    numerical_if_statement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/one_hot_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    one_hot_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/ordinal_array_encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ordinal_array_encode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/round/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    round
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/round_to_decimal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    round_to_decimal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/standard_scale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    standard_scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_affix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_affix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_array_constant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_array_constant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_case
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_concatenate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_concatenate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_contains/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_contains
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_contains_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_contains_list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_equals_if_statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_equals_if_statement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_isin_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_isin_list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_list_to_string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_list_to_string
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_replace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_replace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/string_to_string_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string_to_string_list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/sub_string_delim_at_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sub_string_delim_at_index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/subtract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    subtract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/sum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/layers/unix_timestamp_to_date_time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unix_timestamp_to_date_time
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tensorflow/typing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    typing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_4_2" id="__nav_2_1_1_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_4_2">
            <span class="md-nav__icon md-icon"></span>
            typing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/typing/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tensorflow/utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_4_3" id="__nav_2_1_1_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_1_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/utils/date_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/utils/input_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    input_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/utils/layer_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    layer_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/utils/list_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/utils/shape_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shape_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tensorflow/utils/transform_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transform_utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_5" id="__nav_2_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/dtype_enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dtype_enum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils" class="md-nav__link">
    <span class="md-ellipsis">
      transform_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils._multi_input_single_output_transform" class="md-nav__link">
    <span class="md-ellipsis">
      _multi_input_single_output_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils._single_input_single_output_transform" class="md-nav__link">
    <span class="md-ellipsis">
      _single_input_single_output_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils._single_input_single_output_udf_transform" class="md-nav__link">
    <span class="md-ellipsis">
      _single_input_single_output_udf_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.multi_input_single_output_array_transform" class="md-nav__link">
    <span class="md-ellipsis">
      multi_input_single_output_array_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.multi_input_single_output_scalar_transform" class="md-nav__link">
    <span class="md-ellipsis">
      multi_input_single_output_scalar_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_array_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_array_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_array_udf_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_array_udf_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_scalar_transform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_udf_transform" class="md-nav__link">
    <span class="md-ellipsis">
      single_input_single_output_scalar_udf_transform
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>transform_utils</h1>

<div class="doc doc-object doc-module">



<a id="src.kamae.spark.utils.transform_utils"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils._multi_input_single_output_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_multi_input_single_output_transform</span>


<a href="#src.kamae.spark.utils.transform_utils._multi_input_single_output_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_multi_input_single_output_transform</span><span class="p">(</span>
    <span class="n">input_cols</span><span class="p">,</span>
    <span class="n">input_col_datatypes</span><span class="p">,</span>
    <span class="n">input_col_names</span><span class="p">,</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">scalar</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies either a scalar or array Spark function to multiple input columns and
returns a single output column.</p>
<p>NOTE: This function expects a <code>func</code> that takes a single column returning a single
column. Under the hood we will zip the input columns into a single column and apply
<code>func</code> to the zipped column. Therefore <code>func</code> should be cognizant of the names of
the elements in the zipped array column.</p>
<p>Example adding two input columns together with names <code>input_0</code> and <code>input_1</code>:
func = lambda x: x["input_0"] + x["input_1"]</p>
<p>Ideally this function should not be used directly, the user
should choose one of the below scalar vs array functions for their usecase. As every
transform is either scalar or array, not both. This function is used to reduce code
duplication between the scalar and array functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_cols</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatypes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="pyspark.sql.types.DataType">DataType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input column datatypes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_names</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input column names. If any of the columns are arrays, the names of the elements in the zipped array column will be the same as these names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="pyspark.sql.Column">Column</span>], <span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the zipped input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scalar</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the function to be applied is a scalar function or an array function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_multi_input_single_output_transform</span><span class="p">(</span>
    <span class="n">input_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">],</span>
    <span class="n">input_col_datatypes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DataType</span><span class="p">],</span>
    <span class="n">input_col_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Column</span><span class="p">],</span> <span class="n">Column</span><span class="p">],</span>
    <span class="n">scalar</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies either a scalar or array Spark function to multiple input columns and</span>
<span class="sd">    returns a single output column.</span>

<span class="sd">    NOTE: This function expects a `func` that takes a single column returning a single</span>
<span class="sd">    column. Under the hood we will zip the input columns into a single column and apply</span>
<span class="sd">    `func` to the zipped column. Therefore `func` should be cognizant of the names of</span>
<span class="sd">    the elements in the zipped array column.</span>

<span class="sd">    Example adding two input columns together with names `input_0` and `input_1`:</span>
<span class="sd">    func = lambda x: x[&quot;input_0&quot;] + x[&quot;input_1&quot;]</span>

<span class="sd">    Ideally this function should not be used directly, the user</span>
<span class="sd">    should choose one of the below scalar vs array functions for their usecase. As every</span>
<span class="sd">    transform is either scalar or array, not both. This function is used to reduce code</span>
<span class="sd">    duplication between the scalar and array functions.</span>

<span class="sd">    :param input_cols: List of input columns.</span>
<span class="sd">    :param input_col_datatypes: List of input column datatypes.</span>
<span class="sd">    :param input_col_names: List of input column names. If any of the columns are</span>
<span class="sd">    arrays, the names of the elements in the zipped array column will be the same as</span>
<span class="sd">    these names.</span>
<span class="sd">    :param func: Function to apply to the zipped input column.</span>
<span class="sd">    :param scalar: Whether the function to be applied is a scalar function or an</span>
<span class="sd">    array function.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inputs_are_scalar</span> <span class="o">=</span> <span class="p">[</span>
        <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">ArrayType</span><span class="p">)</span> <span class="k">for</span> <span class="n">datatype</span> <span class="ow">in</span> <span class="n">input_col_datatypes</span>
    <span class="p">]</span>
    <span class="n">inputs_are_array</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">ArrayType</span><span class="p">)</span> <span class="k">for</span> <span class="n">datatype</span> <span class="ow">in</span> <span class="n">input_col_datatypes</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">scalar</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">inputs_are_scalar</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Expected all input columns to be of type ArrayType,</span>
<span class="s2">            received </span><span class="si">{</span><span class="n">input_col_datatypes</span><span class="si">}</span><span class="s2"> instead.&quot;&quot;&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="n">inputs_are_array</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span><span class="n">inputs_are_scalar</span><span class="p">)):</span>
        <span class="c1"># If the inputs are not either all scalar or all arrays, then we have a mix of</span>
        <span class="c1"># scalars and arrays. In this case we need to broadcast the scalars to the size</span>
        <span class="c1"># of the arrays.</span>
        <span class="n">scalar_columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">col_w_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">col_w_datatype</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_cols</span><span class="p">,</span> <span class="n">input_col_datatypes</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_w_datatype</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ArrayType</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">array_columns_w_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">col_w_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_w_datatype</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">col_w_datatype</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_cols</span><span class="p">,</span> <span class="n">input_col_datatypes</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_w_datatype</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ArrayType</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="c1"># Broadcast the scalar to the size of the arrays. Use the first array column</span>
        <span class="c1"># to determine the size of the broadcasted scalar. Assumes all arrays are</span>
        <span class="c1"># of the same size.</span>
        <span class="n">broadcasted_scalars</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="n">idx</span><span class="p">,</span>
                <span class="n">broadcast_scalar_column_to_array</span><span class="p">(</span>
                    <span class="n">scalar_column</span><span class="o">=</span><span class="n">scalar_column</span><span class="p">,</span>
                    <span class="n">array_column</span><span class="o">=</span><span class="n">array_columns_w_types</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">array_column_datatype</span><span class="o">=</span><span class="n">array_columns_w_types</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">scalar_column</span> <span class="ow">in</span> <span class="n">scalar_columns</span>
        <span class="p">]</span>
        <span class="c1"># Resort the array columns and the broadcasted scalars, so they match the order</span>
        <span class="c1"># of the input columns.</span>
        <span class="n">columns_w_idx</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">array_columns_w_types</span>
        <span class="p">]</span> <span class="o">+</span> <span class="n">broadcasted_scalars</span>
        <span class="n">sorted_columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">column</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">columns_w_idx</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="c1"># Check all arrays have same nesting level</span>
        <span class="n">nested_levels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">get_array_nesting_level</span><span class="p">(</span><span class="n">column_dtype</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">column_dtype</span> <span class="ow">in</span> <span class="n">array_columns_w_types</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">nested_level</span> <span class="o">==</span> <span class="n">nested_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">nested_level</span> <span class="ow">in</span> <span class="n">nested_levels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Expected all input columns to have the same array nesting level,</span>
<span class="s2">                received </span><span class="si">{</span><span class="n">nested_levels</span><span class="si">}</span><span class="s2"> instead.&quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="n">nested_level</span> <span class="o">=</span> <span class="n">nested_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">zipped_array_column</span> <span class="o">=</span> <span class="n">nested_arrays_zip</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">sorted_columns</span><span class="p">,</span>
            <span class="n">nest_level</span><span class="o">=</span><span class="n">nested_level</span><span class="p">,</span>
            <span class="n">column_names</span><span class="o">=</span><span class="n">input_col_names</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Otherwise, we have all scalars or all arrays and so can just zip together</span>
        <span class="c1"># the input columns.</span>
        <span class="n">nested_level</span> <span class="o">=</span> <span class="n">get_array_nesting_level</span><span class="p">(</span><span class="n">column_dtype</span><span class="o">=</span><span class="n">input_col_datatypes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">zipped_array_column</span> <span class="o">=</span> <span class="n">nested_arrays_zip</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">input_cols</span><span class="p">,</span> <span class="n">nest_level</span><span class="o">=</span><span class="n">nested_level</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="n">input_col_names</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">scalar</span><span class="p">:</span>
        <span class="c1"># If the function is not scalar then it operates on the full array, therefore</span>
        <span class="c1"># we reduce the nested level by 1.</span>
        <span class="n">nested_level</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="n">nested_func</span> <span class="o">=</span> <span class="n">nested_transform</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">nest_level</span><span class="o">=</span><span class="n">nested_level</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nested_func</span><span class="p">(</span><span class="n">zipped_array_column</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils._single_input_single_output_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_single_input_single_output_transform</span>


<a href="#src.kamae.spark.utils.transform_utils._single_input_single_output_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_single_input_single_output_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">scalar</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies either a scalar or array Spark function to a single input column and returns
a single output column. Ideally this function should not be used directly, the user
should choose one of the below scalar vs array functions for their usecase. As every
transform is either scalar or array, not both. This function is used to reduce code
duplication between the scalar and array functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column datatype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="pyspark.sql.Column">Column</span>], <span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scalar</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the function to be applied is a scalar function or an array function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_single_input_single_output_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Column</span><span class="p">],</span> <span class="n">Column</span><span class="p">],</span>
    <span class="n">scalar</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies either a scalar or array Spark function to a single input column and returns</span>
<span class="sd">    a single output column. Ideally this function should not be used directly, the user</span>
<span class="sd">    should choose one of the below scalar vs array functions for their usecase. As every</span>
<span class="sd">    transform is either scalar or array, not both. This function is used to reduce code</span>
<span class="sd">    duplication between the scalar and array functions.</span>

<span class="sd">    :param input_col: Input column.</span>
<span class="sd">    :param input_col_datatype: Input column datatype.</span>
<span class="sd">    :param func: Function to apply to the input column.</span>
<span class="sd">    :param scalar: Whether the function to be applied is a scalar function or an</span>
<span class="sd">    array function.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">scalar</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">ArrayType</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Input column was expected to be an array but received datatype</span>
<span class="s2">            </span><span class="si">{</span><span class="n">input_col_datatype</span><span class="si">}</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="p">)</span>
    <span class="n">nested_level</span> <span class="o">=</span> <span class="n">get_array_nesting_level</span><span class="p">(</span><span class="n">input_col_datatype</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">scalar</span><span class="p">:</span>
        <span class="c1"># If the function is not scalar then it operates on the full array, therefore</span>
        <span class="c1"># we reduce the nested level by 1.</span>
        <span class="n">nested_level</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">nested_transform_func</span> <span class="o">=</span> <span class="n">nested_transform</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">nested_level</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nested_transform_func</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils._single_input_single_output_udf_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_single_input_single_output_udf_transform</span>


<a href="#src.kamae.spark.utils.transform_utils._single_input_single_output_udf_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_single_input_single_output_udf_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">,</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">udf_return_element_datatype</span><span class="p">,</span>
    <span class="n">scalar</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies a Python function (e.g. a lambda function that we will wrap into a
UDF) to a single input column and returns a single output column. Ideally this
function should not be used directly, the user should choose one of the below scalar
vs array functions for their usecase. As every transform is either scalar or array,
not both. This function is used to reduce code duplication between the scalar and
array functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column datatype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>udf_return_element_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datatype of the UDF return type. Should be the raw underlying type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scalar</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the function to be applied is a scalar function or an array function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_single_input_single_output_udf_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">udf_return_element_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
    <span class="n">scalar</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a Python function (e.g. a lambda function that we will wrap into a</span>
<span class="sd">    UDF) to a single input column and returns a single output column. Ideally this</span>
<span class="sd">    function should not be used directly, the user should choose one of the below scalar</span>
<span class="sd">    vs array functions for their usecase. As every transform is either scalar or array,</span>
<span class="sd">    not both. This function is used to reduce code duplication between the scalar and</span>
<span class="sd">    array functions.</span>

<span class="sd">    :param input_col: Input column.</span>
<span class="sd">    :param input_col_datatype: Input column datatype.</span>
<span class="sd">    :param func: Function to apply to the input column.</span>
<span class="sd">    :param udf_return_element_datatype: Datatype of the UDF return type. Should be the</span>
<span class="sd">    raw underlying type.</span>
<span class="sd">    :param scalar: Whether the function to be applied is a scalar function or an</span>
<span class="sd">    array function.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">scalar</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">ArrayType</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Input column was expected to be an array but received datatype</span>
<span class="s2">            </span><span class="si">{</span><span class="n">input_col_datatype</span><span class="si">}</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="p">)</span>
    <span class="n">nested_level</span> <span class="o">=</span> <span class="n">get_array_nesting_level</span><span class="p">(</span><span class="n">input_col_datatype</span><span class="p">)</span>
    <span class="n">udf_return_type</span> <span class="o">=</span> <span class="n">build_udf_return_type</span><span class="p">(</span>
        <span class="n">element_dtype</span><span class="o">=</span><span class="n">udf_return_element_datatype</span><span class="p">,</span> <span class="n">nest_level</span><span class="o">=</span><span class="n">nested_level</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">scalar</span><span class="p">:</span>
        <span class="c1"># If the function is not scalar then it operates on the full array, therefore</span>
        <span class="c1"># we reduce the nested level by 1.</span>
        <span class="n">nested_level</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="n">nested_lambda_func</span> <span class="o">=</span> <span class="n">nested_lambda</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
        <span class="n">nest_level</span><span class="o">=</span><span class="n">nested_level</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">udf_func</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span><span class="n">nested_lambda_func</span><span class="p">,</span> <span class="n">udf_return_type</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">udf_func</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils.multi_input_single_output_array_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">multi_input_single_output_array_transform</span>


<a href="#src.kamae.spark.utils.transform_utils.multi_input_single_output_array_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">multi_input_single_output_array_transform</span><span class="p">(</span>
    <span class="n">input_cols</span><span class="p">,</span> <span class="n">input_col_datatypes</span><span class="p">,</span> <span class="n">input_col_names</span><span class="p">,</span> <span class="n">func</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies an array Spark function (e.g. a Spark standard library function that
operates on an array directly, as opposed to elementwise on arrays) to multiple
input columns and returns a single output column. Caters for the case, where the
input column is a nested array, in which case the function is applied to the
innermost array.</p>
<p>NOTE: Function zips the multple inputs into a single column and so <code>func</code> should
reference the input names of the new zipped struct column.</p>
<p>Example:
<code>func = lambda x: reduce(add, [x[c] for c in input_col_names])</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_cols</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatypes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="pyspark.sql.types.DataType">DataType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input column datatypes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_names</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input column names. If any of the columns are arrays, the names of the elements in the zipped array column will be the same as these names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="pyspark.sql.Column">Column</span>], <span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input columns in the case they are all scalar. arrays. Main difference here is that the function must be cognizant of the names of the elements in the zipped array column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multi_input_single_output_array_transform</span><span class="p">(</span>
    <span class="n">input_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">],</span>
    <span class="n">input_col_datatypes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DataType</span><span class="p">],</span>
    <span class="n">input_col_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Column</span><span class="p">],</span> <span class="n">Column</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies an array Spark function (e.g. a Spark standard library function that</span>
<span class="sd">    operates on an array directly, as opposed to elementwise on arrays) to multiple</span>
<span class="sd">    input columns and returns a single output column. Caters for the case, where the</span>
<span class="sd">    input column is a nested array, in which case the function is applied to the</span>
<span class="sd">    innermost array.</span>

<span class="sd">    NOTE: Function zips the multple inputs into a single column and so `func` should</span>
<span class="sd">    reference the input names of the new zipped struct column.</span>

<span class="sd">    Example:</span>
<span class="sd">    `func = lambda x: reduce(add, [x[c] for c in input_col_names])`</span>

<span class="sd">    :param input_cols: List of input columns.</span>
<span class="sd">    :param input_col_datatypes: List of input column datatypes.</span>
<span class="sd">    :param input_col_names: List of input column names. If any of the columns are</span>
<span class="sd">    arrays, the names of the elements in the zipped array column will be the same as</span>
<span class="sd">    these names.</span>
<span class="sd">    :param func: Function to apply to the input columns in the case they are all scalar.</span>
<span class="sd">    arrays. Main difference here is that the function must be cognizant of the names of</span>
<span class="sd">    the elements in the zipped array column.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_multi_input_single_output_transform</span><span class="p">(</span>
        <span class="n">input_cols</span><span class="o">=</span><span class="n">input_cols</span><span class="p">,</span>
        <span class="n">input_col_datatypes</span><span class="o">=</span><span class="n">input_col_datatypes</span><span class="p">,</span>
        <span class="n">input_col_names</span><span class="o">=</span><span class="n">input_col_names</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
        <span class="n">scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils.multi_input_single_output_scalar_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">multi_input_single_output_scalar_transform</span>


<a href="#src.kamae.spark.utils.transform_utils.multi_input_single_output_scalar_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">multi_input_single_output_scalar_transform</span><span class="p">(</span>
    <span class="n">input_cols</span><span class="p">,</span> <span class="n">input_col_datatypes</span><span class="p">,</span> <span class="n">input_col_names</span><span class="p">,</span> <span class="n">func</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies a scalar Spark function (e.g. a Spark standard library function that can be
applied elementwise to arrays) to multiple input columns and returns a single output
column. Caters for the case, where the input columns are:</p>
<ol>
<li>All scalars.</li>
<li>All (possibly nested) arrays.</li>
<li>A mix of scalars and (possibly nested) arrays.</li>
</ol>
<p>Zips the arrays into a single (potentially nested array) column.
Applies <code>func</code> to the zipped column. <code>func</code> must be cognizant of the names of the
elements in the zipped array column. If the inputs are a mix of scalars and arrays,
broadcast the scalar to the size of the arrays before zipping the input columns.</p>
<p>Example of <code>func</code> for a transformer that sums a list of input columns:</p>
<p><code>func = lambda x: reduce(add, [x[c] for c in input_col_names])</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_cols</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatypes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="pyspark.sql.types.DataType">DataType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input column datatypes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_names</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of input column names. If any of the columns are arrays, the names of the elements in the zipped array column will be the same as these names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="pyspark.sql.Column">Column</span>], <span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input columns in the case they are all scalar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multi_input_single_output_scalar_transform</span><span class="p">(</span>
    <span class="n">input_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">],</span>
    <span class="n">input_col_datatypes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DataType</span><span class="p">],</span>
    <span class="n">input_col_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Column</span><span class="p">],</span> <span class="n">Column</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a scalar Spark function (e.g. a Spark standard library function that can be</span>
<span class="sd">    applied elementwise to arrays) to multiple input columns and returns a single output</span>
<span class="sd">    column. Caters for the case, where the input columns are:</span>

<span class="sd">    1. All scalars.</span>
<span class="sd">    2. All (possibly nested) arrays.</span>
<span class="sd">    3. A mix of scalars and (possibly nested) arrays.</span>

<span class="sd">    Zips the arrays into a single (potentially nested array) column.</span>
<span class="sd">    Applies `func` to the zipped column. `func` must be cognizant of the names of the</span>
<span class="sd">    elements in the zipped array column. If the inputs are a mix of scalars and arrays,</span>
<span class="sd">    broadcast the scalar to the size of the arrays before zipping the input columns.</span>

<span class="sd">    Example of `func` for a transformer that sums a list of input columns:</span>

<span class="sd">    `func = lambda x: reduce(add, [x[c] for c in input_col_names])`</span>

<span class="sd">    :param input_cols: List of input columns.</span>
<span class="sd">    :param input_col_datatypes: List of input column datatypes.</span>
<span class="sd">    :param input_col_names: List of input column names. If any of the columns are</span>
<span class="sd">    arrays, the names of the elements in the zipped array column will be the same as</span>
<span class="sd">    these names.</span>
<span class="sd">    :param func: Function to apply to the input columns in the case they are all scalar.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_multi_input_single_output_transform</span><span class="p">(</span>
        <span class="n">input_cols</span><span class="o">=</span><span class="n">input_cols</span><span class="p">,</span>
        <span class="n">input_col_datatypes</span><span class="o">=</span><span class="n">input_col_datatypes</span><span class="p">,</span>
        <span class="n">input_col_names</span><span class="o">=</span><span class="n">input_col_names</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
        <span class="n">scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils.single_input_single_output_array_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_input_single_output_array_transform</span>


<a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_array_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">single_input_single_output_array_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies an array Spark function (e.g. a Spark standard library function that
operates on an array directly, as opposed to elementwise on arrays) to a single
input column and returns a single output column. Caters for the case, where the
input column is a nested array, in which case the function is applied to the
innermost array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column datatype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="pyspark.sql.Column">Column</span>], <span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">single_input_single_output_array_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Column</span><span class="p">],</span> <span class="n">Column</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies an array Spark function (e.g. a Spark standard library function that</span>
<span class="sd">    operates on an array directly, as opposed to elementwise on arrays) to a single</span>
<span class="sd">    input column and returns a single output column. Caters for the case, where the</span>
<span class="sd">    input column is a nested array, in which case the function is applied to the</span>
<span class="sd">    innermost array.</span>

<span class="sd">    :param input_col: Input column.</span>
<span class="sd">    :param input_col_datatype: Input column datatype.</span>
<span class="sd">    :param func: Function to apply to the input column.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_single_input_single_output_transform</span><span class="p">(</span>
        <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils.single_input_single_output_array_udf_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_input_single_output_array_udf_transform</span>


<a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_array_udf_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">single_input_single_output_array_udf_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">,</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">udf_return_element_datatype</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies an array Python function (e.g. a lambda function that operates on an array
directly, as opposed to elementwise on arrays which is wrapped into a UDF) to a
single input column and returns a single output column. Caters for the case, where
the input column is a nested array, in which case the function is applied to the
innermost array.</p>
<p><code>func</code> should be provided as a python function, and not wrapped in the Spark UDF
wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column datatype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>udf_return_element_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datatype of the UDF return type. Should be the raw underlying type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">single_input_single_output_array_udf_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">udf_return_element_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies an array Python function (e.g. a lambda function that operates on an array</span>
<span class="sd">    directly, as opposed to elementwise on arrays which is wrapped into a UDF) to a</span>
<span class="sd">    single input column and returns a single output column. Caters for the case, where</span>
<span class="sd">    the input column is a nested array, in which case the function is applied to the</span>
<span class="sd">    innermost array.</span>

<span class="sd">    `func` should be provided as a python function, and not wrapped in the Spark UDF</span>
<span class="sd">    wrapper.</span>

<span class="sd">    :param input_col: Input column.</span>
<span class="sd">    :param input_col_datatype: Input column datatype.</span>
<span class="sd">    :param func: Function to apply to the input column.</span>
<span class="sd">    :param udf_return_element_datatype: Datatype of the UDF return type. Should be the</span>
<span class="sd">    raw underlying type.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_single_input_single_output_udf_transform</span><span class="p">(</span>
        <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">udf_return_element_datatype</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_input_single_output_scalar_transform</span>


<a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">single_input_single_output_scalar_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies a scalar Spark function (e.g. a Spark standard library function that can be
applied elementwise to arrays) to a single input column and returns a single output
column. Caters for the case, where the input column is:</p>
<ol>
<li>A scalar.</li>
<li>A (possibly nested) array.</li>
</ol>
<p>If the input is a scalar, apply <code>func</code> directly to the input column.
If the input is an array, apply <code>func</code> elementwise to the input column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column datatype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="pyspark.sql.Column">Column</span>], <span title="pyspark.sql.Column">Column</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">single_input_single_output_scalar_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Column</span><span class="p">],</span> <span class="n">Column</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a scalar Spark function (e.g. a Spark standard library function that can be</span>
<span class="sd">    applied elementwise to arrays) to a single input column and returns a single output</span>
<span class="sd">    column. Caters for the case, where the input column is:</span>

<span class="sd">    1. A scalar.</span>
<span class="sd">    2. A (possibly nested) array.</span>

<span class="sd">    If the input is a scalar, apply `func` directly to the input column.</span>
<span class="sd">    If the input is an array, apply `func` elementwise to the input column.</span>

<span class="sd">    :param input_col: Input column.</span>
<span class="sd">    :param input_col_datatype: Input column datatype.</span>
<span class="sd">    :param func: Function to apply to the input column.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_single_input_single_output_transform</span><span class="p">(</span>
        <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_udf_transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_input_single_output_scalar_udf_transform</span>


<a href="#src.kamae.spark.utils.transform_utils.single_input_single_output_scalar_udf_transform" class="headerlink" title="Permanent link"></a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">single_input_single_output_scalar_udf_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">,</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">udf_return_element_datatype</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Applies a scalar Python function (e.g. a lambda function that we will wrap into a
UDF) to a single input column and returns a single output column. Caters for the
case, where the input column is:</p>
<ol>
<li>A scalar.</li>
<li>A (possibly nested) array.</li>
</ol>
<p>If the input is a scalar, apply <code>func</code> directly to the input column.
If the input is an array, apply <code>func</code> elementwise to the input column.</p>
<p><code>func</code> should be provided as a python function, and not wrapped in the Spark UDF
wrapper.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input column datatype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply to the input column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>udf_return_element_datatype</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datatype of the UDF return type. Should be the raw underlying type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/kamae/spark/utils/transform_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">single_input_single_output_scalar_udf_transform</span><span class="p">(</span>
    <span class="n">input_col</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span>
    <span class="n">input_col_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">udf_return_element_datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a scalar Python function (e.g. a lambda function that we will wrap into a</span>
<span class="sd">    UDF) to a single input column and returns a single output column. Caters for the</span>
<span class="sd">    case, where the input column is:</span>

<span class="sd">    1. A scalar.</span>
<span class="sd">    2. A (possibly nested) array.</span>

<span class="sd">    If the input is a scalar, apply `func` directly to the input column.</span>
<span class="sd">    If the input is an array, apply `func` elementwise to the input column.</span>

<span class="sd">    `func` should be provided as a python function, and not wrapped in the Spark UDF</span>
<span class="sd">    wrapper.</span>

<span class="sd">    :param input_col: Input column.</span>
<span class="sd">    :param input_col_datatype: Input column datatype.</span>
<span class="sd">    :param func: Function to apply to the input column.</span>
<span class="sd">    :param udf_return_element_datatype: Datatype of the UDF return type. Should be the</span>
<span class="sd">    raw underlying type.</span>
<span class="sd">    :returns: Output column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_single_input_single_output_udf_transform</span><span class="p">(</span>
        <span class="n">input_col</span><span class="p">,</span> <span class="n">input_col_datatype</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">udf_return_element_datatype</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../../..", "features": [], "search": "../../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>